"use strict";exports.__esModule=!0;var SettingsAPI_1=require("./SettingsAPI"),pluginmanager_1=require("@mcscriptstudiocode/pluginmanager"),util_1=require("@mcscriptstudiocode/util"),$=require("jquery"),fs=require("fs"),marked=require("marked"),api=pluginmanager_1.PluginManager.instance.api;function createInfoTableEntry(e,t){var n=[];return n[0]=document.createElement("tr"),n[1]=document.createElement("th"),n[2]=document.createElement("th"),n[1].innerText=e,n[2].innerText=t,n[0].appendChild(n[1]),n[0].appendChild(n[2]),n[0]}function createConfigEditor(e,t,n){if(void 0===t&&(t=util_1.guid()),void 0===n&&(n=util_1.guid()),fs.existsSync(e.path+"/config.yml")){var i=document.createElement("div"),a=document.createElement("textarea"),d=document.createElement("button"),r=document.createElement("h3");return i.classList.add("config"),r.innerText="Config",a.value=fs.readFileSync(e.path+"/config.yml","utf8"),a.id=t,d.innerText="Save",d.id=n,i.appendChild(r),i.appendChild(a),i.appendChild(d),i}}function createReadmeViewer(e){if(fs.existsSync(e.path+"/README.md")){var t=fs.readFileSync(e.path+"/README.md","utf8"),n=marked(t),i=document.createElement("div"),a=document.createElement("div"),d=document.createElement("h3");return i.classList.add("readme"),a.classList.add("readme-content"),d.innerText="Readme",a.innerHTML=n,i.appendChild(a),i}}SettingsAPI_1.settingsapi.push({name:"plugins",renderContent:function(){var e=document.createElement("div"),s=document.createElement("ul"),o=document.createElement("div");return o.style.display="none",e.id="settings_plugins",s.classList.add("settings_plugins","menu"),o.classList.add("settings_plugins","content"),api.plugins.forEach(function(n){var e=document.createElement("li"),t=document.createElement("p"),i=document.createElement("div"),a=document.createElement("h3"),d=document.createElement("table");i.classList.add("infos"),d.classList.add("infostable"),a.classList.add("infoheadline"),a.innerText="Infos",d.appendChild(createInfoTableEntry("Name",""+n.name)),d.appendChild(createInfoTableEntry("Url",""+n.url)),d.appendChild(createInfoTableEntry("Version","v"+n.version)),d.appendChild(createInfoTableEntry("Author",""+n.author)),d.appendChild(createInfoTableEntry("Author's url",""+n.author_url)),i.appendChild(a),i.appendChild(d),t.innerText=n.name,e.appendChild(t);var r=util_1.guid(),l=util_1.guid(),c=createConfigEditor(n,r,l),u=createReadmeViewer(n);$(e).click(function(){if($(s).hide(),$(o).show(),$(o).empty(),$(o).append(i),c){$(o).append(c);var t=api.getAPI("editor").createEditor(document.getElementById(r),"text/x-yaml","3024-night");$("#"+l).click(function(e){return e.preventDefault(),fs.writeFileSync(n.path+"/config.yml",t.getValue(),"utf8"),!1})}u&&$(o).append(u)}),s.appendChild(e)}),e.appendChild(s),e.appendChild(o),e}});
//# sourceMappingURL=plugins.js.map
