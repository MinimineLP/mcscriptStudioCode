{"version":3,"sources":["Plugins.js","Plugins.ts"],"names":["exports","__esModule","SettingsAPI_1","require","pluginmanager_1","$","fs","api","PluginManager","instance","createInfoTableEntry","key","value","name","document","createElement","innerText","appendChild","createConfigEditor","plugin","textareaid","savebuttonid","guid","existsSync","path","div","config","save","h3","classList","add","readFileSync","id","settingsapi","push","renderContent","main","ul","cont","style","display","plugins","forEach","li","p","infos","table","url","version","author","author_url","configid","configSaveId","click","hide","show","empty","append","editor_1","getAPI","createEditor","getElementById","e","preventDefault","writeFileSync","getValue"],"mappings":"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","file":"Plugins.js","sourcesContent":["\"use strict\";\nexports.__esModule = true;\nvar SettingsAPI_1 = require(\"./SettingsAPI\");\nvar pluginmanager_1 = require(\"@mcscriptstudiocode/pluginmanager\");\nvar $ = require(\"jquery\");\nvar fs = require(\"fs\");\nvar api = pluginmanager_1.PluginManager.instance.api;\nSettingsAPI_1.settingsapi.push({\n    name: \"plugins\",\n    renderContent: function () {\n        var main = document.createElement('div');\n        var ul = document.createElement('ul');\n        var cont = document.createElement('div');\n        cont.style.display = \"none\";\n        main.id = \"settings_plugins\";\n        ul.classList.add(\"settings_plugins\", \"menu\");\n        cont.classList.add(\"settings_plugins\", \"content\");\n        api.plugins.forEach(function (plugin) {\n            var li = document.createElement('li');\n            var p = document.createElement('p');\n            var infos = document.createElement(\"div\");\n            var h3 = document.createElement(\"h3\");\n            var table = document.createElement(\"table\");\n            infos.classList.add(\"infos\");\n            table.classList.add(\"infostable\");\n            h3.classList.add(\"infoheadline\");\n            h3.innerText = \"Infos\";\n            table.appendChild(createInfoTableEntry(\"Name\", \"\" + plugin.name));\n            table.appendChild(createInfoTableEntry(\"Url\", \"\" + plugin.url));\n            table.appendChild(createInfoTableEntry(\"Version\", \"v\" + plugin.version));\n            table.appendChild(createInfoTableEntry(\"Author\", \"\" + plugin.author));\n            table.appendChild(createInfoTableEntry(\"Author's url\", \"\" + plugin.author_url));\n            infos.appendChild(h3);\n            infos.appendChild(table);\n            p.innerText = plugin.name;\n            li.appendChild(p);\n            var configid = pluginmanager_1.guid();\n            var configSaveId = pluginmanager_1.guid();\n            var config = createConfigEditor(plugin, configid, configSaveId);\n            $(li).click(function () {\n                $(ul).hide();\n                $(cont).show();\n                $(cont).empty();\n                $(cont).append(infos);\n                if (config) {\n                    $(cont).append(config);\n                    var editor_1 = api.getAPI(\"editor\").createEditor(document.getElementById(configid), \"text/x-yaml\", \"3024-night\");\n                    $(\"#\" + configSaveId).click(function (e) {\n                        e.preventDefault();\n                        fs.writeFileSync(plugin.path + \"/config.yml\", editor_1.getValue(), \"utf8\");\n                        return false;\n                    });\n                }\n            });\n            ul.appendChild(li);\n        });\n        main.appendChild(ul);\n        main.appendChild(cont);\n        return main;\n    }\n});\nfunction createInfoTableEntry(key, value) {\n    var name = [];\n    name[0] = document.createElement(\"tr\");\n    name[1] = document.createElement(\"th\");\n    name[2] = document.createElement(\"th\");\n    name[1].innerText = key;\n    name[2].innerText = value;\n    name[0].appendChild(name[1]);\n    name[0].appendChild(name[2]);\n    return name[0];\n}\nfunction createConfigEditor(plugin, textareaid, savebuttonid) {\n    if (textareaid === void 0) { textareaid = pluginmanager_1.guid(); }\n    if (savebuttonid === void 0) { savebuttonid = pluginmanager_1.guid(); }\n    if (!fs.existsSync(plugin.path + \"/config.yml\"))\n        return;\n    var div = document.createElement(\"div\");\n    var config = document.createElement(\"textarea\");\n    var save = document.createElement(\"button\");\n    var h3 = document.createElement(\"h3\");\n    div.classList.add(\"config\");\n    h3.innerText = \"Config\";\n    config.value = fs.readFileSync(plugin.path + \"/config.yml\", \"utf8\");\n    config.id = textareaid;\n    save.innerText = \"Save\";\n    save.id = savebuttonid;\n    div.appendChild(h3);\n    div.appendChild(config);\n    div.appendChild(save);\n    return div;\n}\n","import {settingsapi} from './SettingsAPI';\r\nimport {PluginManager,ServerApi,Plugin, guid} from '@mcscriptstudiocode/pluginmanager';\r\nimport * as $ from 'jquery';\r\nimport * as fs from 'fs';\r\nlet api:ServerApi = PluginManager.instance.api;\r\n\r\nsettingsapi.push({\r\n  name: \"plugins\",\r\n  renderContent: function():string|HTMLElement {\r\n    let main:HTMLDivElement = document.createElement('div');\r\n    let ul:HTMLUListElement = document.createElement('ul');\r\n    let cont:HTMLDivElement = document.createElement('div');\r\n    cont.style.display = \"none\";\r\n    main.id = \"settings_plugins\";\r\n    ul.classList.add(\"settings_plugins\", \"menu\");\r\n    cont.classList.add(\"settings_plugins\", \"content\");\r\n    api.plugins.forEach((plugin:Plugin) => {\r\n\r\n      let li:HTMLLIElement = document.createElement('li');\r\n      let p:HTMLParagraphElement = document.createElement('p');\r\n      let infos:HTMLDivElement = document.createElement(\"div\");\r\n      let h3:HTMLElement = document.createElement(\"h3\");\r\n      let table:HTMLTableElement = document.createElement(\"table\");\r\n\r\n      infos.classList.add(\"infos\")\r\n      table.classList.add(\"infostable\")\r\n      h3.classList.add(\"infoheadline\")\r\n\r\n      h3.innerText = \"Infos\";\r\n\r\n      table.appendChild(createInfoTableEntry(\"Name\", \"\"+plugin.name));\r\n      table.appendChild(createInfoTableEntry(\"Url\", \"\"+plugin.url));\r\n      table.appendChild(createInfoTableEntry(\"Version\", \"v\"+plugin.version));\r\n      table.appendChild(createInfoTableEntry(\"Author\", \"\"+plugin.author));\r\n      table.appendChild(createInfoTableEntry(\"Author's url\", \"\"+plugin.author_url));\r\n\r\n      infos.appendChild(h3);\r\n      infos.appendChild(table);\r\n\r\n      p.innerText = plugin.name;\r\n      li.appendChild(p);\r\n\r\n      let configid = guid();\r\n      let configSaveId = guid();\r\n      let config = createConfigEditor(plugin,configid,configSaveId);\r\n\r\n      $(li).click(() => {\r\n        $(ul).hide();\r\n        $(cont).show();\r\n        $(cont).empty();\r\n        $(cont).append(infos);\r\n        if(config) {\r\n          $(cont).append(config)\r\n          let editor = api.getAPI(\"editor\").createEditor(document.getElementById(configid),\"text/x-yaml\", \"3024-night\")\r\n          $(`#${configSaveId}`).click((e) => {\r\n            e.preventDefault()\r\n            fs.writeFileSync(`${plugin.path}/config.yml`, editor.getValue(), \"utf8\");\r\n            return false;\r\n          })\r\n        }\r\n      });\r\n      ul.appendChild(li);\r\n    });\r\n    main.appendChild(ul);\r\n    main.appendChild(cont);\r\n    return main;\r\n  }\r\n});\r\n\r\nfunction createInfoTableEntry(key:string,value:string):HTMLTableRowElement {\r\n  let name:HTMLElement[] = [];\r\n  name[0] = document.createElement(\"tr\");\r\n  name[1] = document.createElement(\"th\");\r\n  name[2] = document.createElement(\"th\");\r\n  name[1].innerText = key;\r\n  name[2].innerText = value;\r\n  name[0].appendChild(name[1])\r\n  name[0].appendChild(name[2])\r\n  return <HTMLTableRowElement>name[0];\r\n}\r\n\r\nfunction createConfigEditor(plugin:Plugin,textareaid:string=guid(),savebuttonid:string=guid()):HTMLDivElement {\r\n\r\n  if(!fs.existsSync(`${plugin.path}/config.yml`))return;\r\n\r\n  let div:HTMLDivElement = document.createElement(\"div\");\r\n  let config:HTMLTextAreaElement = document.createElement(\"textarea\");\r\n  let save:HTMLButtonElement = document.createElement(\"button\");\r\n  let h3:HTMLElement = document.createElement(\"h3\");\r\n\r\n  div.classList.add(\"config\")\r\n  h3.innerText = \"Config\";\r\n  config.value = fs.readFileSync(`${plugin.path}/config.yml`, \"utf8\");\r\n  config.id = textareaid;\r\n\r\n  save.innerText = \"Save\"\r\n  save.id = savebuttonid;\r\n\r\n  div.appendChild(h3);\r\n  div.appendChild(config);\r\n  div.appendChild(save);\r\n\r\n  return div;\r\n}\r\n"]}