"use strict";window.onbeforeunload=function(){return!1};var editor={highlights:server.loadFileSync("/hightlights.json"),actual:void 0,opened:{},getMode:function(e){return editor.highlights[e]?editor.highlights[e]:e},save:function(){editor.actual?editor.opened[editor.actual].save():swal("Nothing to save!","Sorry, but there is nothing to save, please select a file!","error")},undo:function(){editor.actual?editor.opened[editor.actual].editor.undo():swal("Nothing to undo!","Sorry, but there is nothing to undo, please select a file!","error")},redo:function(){editor.actual?editor.opened[editor.actual].editor.redo():swal("Nothing to redo!","Sorry, but there is nothing to redo, please select a file!","error")},open:function(e){if(editor.opened[e])return!1;var t=server.getFileSync(e).file;$("#editorcontainer .CodeMirror").hide(),editor.actual=e;var o=createEditor(editor.getMode(t.type),t.content),i=o.div,r=o.editor;o.save=function(){server.saveFile(e,r.getDoc().getValue()).then(function(t){editor.opened[e].content=r.getDoc().getValue(),n.removeClass("edited"),swal("Successfully saved!",'File successfully saved to "'+t.file.path+'"',"success")})},editor.opened[e]=o,$("#editorfiles div.openedfile.selected").removeClass("selected"),$("#editorfiles #editorfilescontainer").append('<div class="openedfile selected" path="'+e+'"><p>'+t.name+'</p><i class="material-icons close">close</i></div>');var n=$("#editorfiles div.selected");$("#editorfiles div.selected").click(function(t){$("#editorfiles div.openedfile.selected").removeClass("selected"),$(this).addClass("selected"),editor.actual=e,$("#editorcontainer .CodeMirror").hide(),$(i).show()}).children("i.close").click(function(){return $(this).is(".selected")&&(editor.actual=void 0),server.sendUpdateCloseFile(e),$(this).parent().remove(),$(i).remove(),delete editor.opened[e],!1}),r.on("change",function(t){editor.opened[e].content!=r.getDoc().getValue()?n.addClass("edited"):n.removeClass("edited")})}};function createEditor(e,t){var o=guid();$("#editorcontainer").append('<textarea id="'+o+'">'+t+"</textarea>");var i=CodeMirror.fromTextArea(document.getElementById(o),{mode:e,tabSize:4,lineNumbers:!0,firstLineNumber:1,extraKeys:{"Ctrl-Space":"autocomplete","Alt-F":"findPersistent",F11:function(e){e.setOption("fullScreen",!e.getOption("fullScreen"))},Esc:function(e){e.getOption("fullScreen")&&e.setOption("fullScreen",!1)},"Ctrl-Q":function(e){e.foldCode(e.getCursor())}},lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","breakpoints","CodeMirror-foldgutter"],scrollbarStyle:"simple",styleActiveLine:!0,theme:"mtheme"});i.on("gutterClick",function(e,t){var o,i=e.lineInfo(t);e.setGutterMarker(t,"breakpoints",i.gutterMarkers?null:((o=document.createElement("div")).style.color="#822",o.innerHTML='<font color="red">&bull;</font>',o))});var r=guid();return $("#editorcontainer .CodeMirror").not(".hasid").attr("id",r),$("#editorcontainer .CodeMirror").not(".hasid").addClass("hasid"),$("#id").remove(),t=i.getDoc().getValue(),{editor:i,id:o,div:document.getElementById(r),content:t}}$(document).ready(function(){setInterval(function(){$("#editorcontainer").height($(window).height()-20),$("#editorcontainer").width($(window).width()-300),$("#editorcontainer .CodeMirror").height($("#editorcontainer").height()-31),$("#editorcontainer .CodeMirror").width($("#editorcontainer").width()-2),$("#editorcontainer #editorfiles").width($("#editorcontainer").width()-2)},10),$("#editorcontainer .CodeMirror").hide()});