"use strict";exports.__esModule=!0;var YAML=require("js-yaml"),fs=require("fs"),Config=function(){function Config(t,i){if(void 0===i&&(i=FileFormatters.Json),"string"==typeof i&&(i=FileFormatters.fromString(i)),this.parser=i,this.file=t,!fs.existsSync(t)){for(var o=(t=t.replace("\\","/")).split("/"),n=1;n<o.length;n++){for(var r="",e=0;e<n;e++)r+=o[e]+"/";fs.existsSync(r)||fs.mkdirSync(r)}fs.writeFileSync(t,"")}this.load()}return Config.prototype.load=function(t,i){void 0===t&&(t=this.file),void 0===i&&(i=this.parser),"string"==typeof i&&(i=FileFormatters.fromString(i)),this.content=i.parse(fs.readFileSync(t,"utf8")),null==this.content&&(this.content={})},Config.prototype.save=function(t,i){void 0===t&&(t=this.file),void 0===i&&(i=this.parser),"string"==typeof i&&(i=FileFormatters.fromString(i)),fs.writeFileSync(t,i.stringify(this.content))},Config.prototype.stringify=function(t){return void 0===t&&(t=this.parser),"string"==typeof t&&(t=FileFormatters.fromString(t)),t.stringify(this.content)},Config.prototype.contains=function(t,i){void 0===i&&(i=this.content);var o=t.split(/\./g),n=[];if(i.hasOwnProperty(o[0])){for(var r=1;r<o.length;r++)n[r-1]=o[r];return!(i[o[0]]instanceof Object)||this.contains(n.join("."),i[o[0]])}return!1},Config.prototype.get=function(t,i){if(void 0===i&&(i=this.content),this.contains(t,i)){for(var o=t.split(/\./g),n=0;n<o.length;n++)i=i[o[n]];return i}return console.log('Ooups... Trying to get empty path from Yaml: "'+t+'" Returning null!'),null},Config.prototype.set=function(path,val){for(var parts=path.split("."),obj=this.content,i=0;i<parts.length-1;i++)obj[parts[i]]&&obj[parts[i]]instanceof Object||(obj[parts[i]]={}),obj=obj[parts[i]];var cmd="this.content."+path+" = val;";eval(cmd)},Config.prototype.remove=function(path){for(var parts=path.split("."),obj=this.content,i=0;i<parts.length-1;i++)obj[parts[i]]&&obj[parts[i]]instanceof Object||(obj[parts[i]]={}),obj=obj[parts[i]];var cmd='delete this.content."'+path+";";eval(cmd)},Config.prototype.setStandart=function(t,i){this.contains(t)||this.set(t,i)},Config.prototype.concat=function(i){var o=this;i instanceof Config?i.list().forEach(function(t){o.contains(t)||o.set(t,i.get(t))}):this.list(i).forEach(function(t){o.contains(t)||o.set(t,o.get(t,i))})},Config.prototype.apply=function(i){var o=this;i instanceof Config?i.list().forEach(function(t){o.set(t,i.get(t))}):this.list(i).forEach(function(t){o.set(t,o.get(t,i))})},Config.prototype.list=function(t){var o=this;void 0===t&&(t=this.content);var i=Object.keys(t),n=[];return i.forEach(function(i){t[i]instanceof Object?o.list(t[i]).forEach(function(t){n.push(i+"."+t)}):n.push(i)}),n},Config}(),FileFormatters;exports.Config=Config,function(t){var i=function(){this.stringify=JSON.stringify,this.parse=JSON.parse},o=function(){this.stringify=YAML.safeDump,this.parse=YAML.safeLoad};t.Json=new i,t.Yaml=new o,t.fromString=function(t){return"json"==(t=t.toLowerCase())?this.Json:"yaml"==t?this.Yaml:null}}(FileFormatters||(FileFormatters={})),exports.FileFormatters=FileFormatters;var config=new Config("config.yml",FileFormatters.Yaml);function loadConfig(){config.load(),config.save()}exports.config=config,loadConfig(),global.FileFormatters=FileFormatters,global.Config=Config,global.config=config,exports.default=config;