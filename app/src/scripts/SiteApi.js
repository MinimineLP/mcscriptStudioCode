"use strict";var __awaiter=function(a,i,s,l){return new(s||(s=Promise))(function(t,e){function n(t){try{r(l.next(t))}catch(t){e(t)}}function o(t){try{r(l.throw(t))}catch(t){e(t)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,o)}r((l=l.apply(a,i||[])).next())})},__generator=function(n,o){var r,a,i,t,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,a&&(i=2&e[0]?a.return:e[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,e[1])).done)return i;switch(a=0,i&&(e=[2&e[0],i.value]),e[0]){case 0:case 1:i=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,a=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){s.label=e[1];break}if(6===e[0]&&s.label<i[1]){s.label=i[1],i=e;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(e);break}i[2]&&s.ops.pop(),s.trys.pop();continue}e=o.call(n,s)}catch(t){e=[6,t],a=0}finally{r=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};exports.__esModule=!0;var http=require("http"),https=require("https"),fs=require("fs");function loadSite(o,r,a,i){return void 0===a&&(a="/"),void 0===i&&(i="https"),__awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:return o instanceof Object&&o.host&&o.path&&(o.protocoll&&(i=o.protocoll),a=o.path,o=o.host),"https"!=i?[3,2]:(e={host:o,path:a},(n=https.request(e,function(t){var e="";t.on("data",function(t){e+=t}),t.on("end",function(){r(e)})})).on("error",function(t){console.log(t.message)}),[4,n.end()]);case 1:return t.sent(),[3,5];case 2:return"http"!=i?[3,4]:(e={host:o,path:a},(n=http.request(e,function(t){var e="";t.on("data",function(t){e+=t}),t.on("end",function(){r(e)})})).on("error",function(t){console.log(t.message)}),[4,n.end()]);case 3:return t.sent(),[3,5];case 4:throw new Error('Unknown protocoll "'+i+'"');case 5:return[2,void 0]}})})}function parseURL(t){var e,n,o,r;return null!=(r=t.match(/(https|http):\/\/?(.[^\/:]+)/i))&&2<r.length&&"string"==typeof r[2]&&0<r[2].length&&(e=r[2]),null!=(r=t.match(/(https|http):\/\/.[^\/:]+(.*)/i))&&2<r.length&&"string"==typeof r[2]&&0<r[2].length?(n=r[2],t.startsWith("https://")&&(o="https"),t.startsWith("http://")&&(o="http"),{host:e,path:n,protocoll:o}):null}function downloadFile(t,e,n){void 0===n&&(n=function(){});var o,r=fs.createWriteStream(t);o=e.startsWith("https")?(console.log(e,t,"https"),https.get(e,function(t){t.pipe(r)})):http.get(e,function(t){t.pipe(r)}),r.on("finish",n),o.end()}exports.loadSite=loadSite,exports.parseURL=parseURL,exports.downloadFile=downloadFile;